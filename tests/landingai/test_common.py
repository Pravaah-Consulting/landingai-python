import numpy as np

from landingai.common import decode_bitmap_rle


def test_decode_bitmap_rle():
    encoded_mask = "2134600Z21N2027Z21N2027Z21N2022Z31N2017Z31N2017Z31N2012Z38N2010Z38N2007Z41N2007Z41N2007Z41N2005Z46N2002Z46N1999Z49N1999Z49N1999Z49N1997Z51N1997Z51N1992Z58N1990Z58N1990Z58N1979Z69N1979Z69N1972Z76N1972Z76N1972Z76N1969Z82N1966Z82N1966Z82N1964Z84N1964Z84N1961Z87N1961Z87N1961Z87N1961Z87N1961Z87N1900Z12N46Z90N1900Z12N46Z90N1900Z12N46Z90N1889Z26N41Z89N1892Z26N41Z89N1890Z33N31Z92N1892Z33N31Z92N1892Z33N31Z92N1892Z38N13Z105N1892Z38N13Z105N1889Z156N1892Z156N1892Z156N1892Z156N1892Z156N1892Z156N1892Z156N1892Z156N1892Z154N1894Z154N1894Z154N1892Z153N1895Z153N1895Z148N1900Z148N1900Z148N1900Z140N1908Z140N1908Z138N1910Z138N1910Z138N1910Z135N1913Z135N1913Z135N1913Z133N1915Z133N1912Z136N1912Z136N1912Z136N1912Z131N1917Z131N1920Z117N1931Z117N1931Z117N1931Z112N1936Z112N1936Z107N1941Z107N1941Z107N1941Z102N1946Z102N1948Z97N1951Z97N1951Z97N1951Z95N1953Z95N1953Z95N1953Z92N1956Z92N1959Z87N1961Z87N1961Z87N1961Z84N1964Z84N1966Z80N1968Z80N1968Z80N1971Z74N1974Z74N1976Z70N1978Z70N1978Z70N1981Z67N1981Z67N1981Z64N1984Z64N1984Z64N1987Z61N1987Z61N1987Z61N1989Z59N1989Z59N1989Z59N1989Z59N1989Z59N1992Z56N1992Z56N1994Z57N1991Z57N1991Z57N1994Z54N1994Z54N1996Z52N1996Z52N1996Z52N1999Z49N1999Z49N1999Z49N2001Z47N2001Z47N2001Z47N2001Z47N2001Z47N2004Z44N2004Z44N2009Z36N2012Z36N2012Z36N2015Z30N2018Z30N2025Z21N2027Z21N2027Z21N2035Z10N2038Z10N2043Z3N2045Z3N2045Z3N511321Z5N2043Z5N2043Z5N2031Z28N2020Z28N2012Z43N2005Z43N2005Z43N2002Z51N1997Z51N1997Z51N1992Z59N1989Z59N1987Z64N1984Z64N1984Z64N1978Z72N1976Z72N1974Z77N1971Z77N1971Z77N1963Z87N1961Z87N1951Z100N1948Z100N1948Z100N1943Z107N1941Z107N1938Z113N1935Z113N1935Z113N1930Z121N1927Z121N1927Z121N1920Z130N1918Z130N1912Z139N1909Z139N1909Z139N1904Z146N1902Z146N1900Z148N1900Z148N1900Z148N1897Z154N1894Z154N1892Z158N1890Z158N1890Z158N1884Z167N1881Z167N1881Z167N1879Z169N1879Z169N1874Z176N1872Z176N1872Z176N1864Z187N1861Z187N1853Z195N1853Z195N1853Z195N1848Z203N1845Z203N1843Z205N1843Z205N1843Z205N1838Z210N1838Z210N1835Z213N1835Z213N1835Z213N1830Z220N1828Z220N1828Z220N1823Z225N1823Z225N1818Z230N1818Z230N1818Z230N1813Z235N1813Z235N1805Z246N1802Z246N1802Z246N1794Z254N1794Z254N1789Z259N1789Z259N1789Z259N1784Z264N1784Z264N1776Z272N1776Z272N1776Z272N1769Z279N1769Z279N1769Z279N1761Z287N1761Z287N1751Z297N1751Z297N1751Z297N1743Z302N1746Z302N1736Z312N1736Z312N1736Z312N1723Z323N1725Z323N1712Z333N1715Z333N1715Z333N1710Z335N1713Z335N1713Z335N1705Z343N1705Z343N1700Z346N1702Z346N1702Z346N1631Z23N7Z384N1634Z23N7Z384N1634Z414N1634Z414N1634Z414N1634Z412N1636Z412N1636Z409N1639Z409N1639Z409N1639Z407N1641Z407N1641Z402N1646Z402N1646Z402N1646Z399N1649Z399N1649Z399N1651Z394N1654Z394N1654Z389N1659Z389N1659Z389N1659Z387N1661Z387N1664Z381N1667Z381N1667Z381N1667Z379N1669Z379N1671Z371N1677Z371N1677Z371N1677Z369N1679Z369N1679Z364N1684Z364N1684Z364N1684Z361N1687Z361N1687Z361N1690Z353N1695Z353N1695Z351N1697Z351N1697Z351N1697Z348N1700Z348N1697Z348N1700Z348N1700Z348N1700Z343N1705Z343N1705Z338N1710Z338N1710Z338N1160Z23N525Z335N1165Z23N525Z335N1165Z23N525Z335N1157Z39N517Z333N1159Z39N517Z333N1157Z46N512Z330N1160Z46N512Z330N1160Z46N512Z330N1157Z54N507Z322N1165Z54N507Z322N1165Z59N504Z305N1180Z59N504Z305N1180Z59N504Z305N1178Z66N502Z74N3Z220N1183Z66N502Z74N3Z220N1180Z74N499Z67N10Z213N1185Z74N499Z67N10Z213N1185Z74N499Z67N10Z213N1180Z84N497Z51N23Z210N1183Z84N497Z51N23Z210N1180Z92N495Z43N31Z202N1185Z92N495Z43N31Z202N1185Z92N495Z43N31Z202N1183Z100N489Z40N36Z197N1186Z100N489Z40N36Z197N1186Z100N489Z40N36Z197N1186Z105N486Z33N44Z192N1188Z105N486Z33N44Z192N1185Z110N487Z28N46Z187N1190Z110N487Z28N46Z187N1190Z110N487Z28N46Z187N1190Z110N489Z26N46Z179N1198Z110N489Z26N46Z179N1198Z113N499Z10N49Z169N1208Z113N499Z10N49Z169N1208Z113N499Z10N49Z169N1208Z115N502Z5N49Z164N1213Z115N502Z5N49Z164N1213Z115N505Z2N49Z159N1218Z115N505Z2N49Z159N1218Z115N505Z2N49Z159N1218Z118N553Z153N1224Z118N553Z153N1224Z120N551Z151N1226Z120N551Z151N1226Z120N551Z151N1226Z123N548Z148N1229Z123N548Z148N1229Z123N548Z148N1229Z123N548Z146N1231Z123N548Z146N1234Z120N543Z146N1239Z120N543Z146N1239Z120N543Z146N1241Z118N535Z149N1246Z118N535Z149N1254Z110N525Z151N1262Z110N525Z151N1262Z110N525Z151N1265Z104N525Z151N1268Z104N525Z151N1270Z102N523Z148N1275Z102N523Z148N1275Z102N523Z148N1278Z99N520Z149N1280Z99N520Z149N1280Z99N520Z149N1282Z97N518Z148N1285Z97N518Z148N1285Z97N515Z149N1287Z97N515Z149N1287Z97N515Z149N1290Z92N514Z131N1311Z92N514Z131N1313Z90N512Z130N1316Z90N512Z130N1316Z90N512Z130N1316Z85N517Z128N1318Z85N517Z128N1321Z79N520Z125N1324Z79N520Z125N1324Z79N520Z125N1324Z74N522Z126N1326Z74N522Z126N1328Z70N524Z123N1331Z70N524Z123N1331Z70N524Z123N1331Z67N527Z123N1331Z67N527Z123N1331Z67N527Z123N1331Z67N527Z123N1331Z67N527Z123N1331Z67N530Z118N1333Z67N530Z118N1333Z67N530Z118N1331Z69N532Z116N1331Z69N532Z116N1331Z69N532Z116N1331Z69N532Z116N1331Z69N532Z116N1328Z72N535Z113N1328Z72N535Z113N1326Z74N535Z113N1326Z74N535Z113N1326Z74N535Z113N1323Z77N535Z113N1323Z77N535Z113N1323Z77N535Z113N1323Z77N535Z113N1323Z77N535Z113N1323Z74N541Z110N1323Z74N541Z110N1323Z74N541Z110N1321Z76N541Z107N1324Z76N541Z107N1324Z74N545Z105N1324Z74N545Z105N1324Z74N545Z105N1324Z74N548Z102N1324Z74N548Z102N1324Z71N556Z95N1326Z71N556Z95N1326Z71N556Z95N1326Z69N560Z93N1326Z69N560Z93N1323Z69N569Z84N1326Z69N569Z84N1326Z69N569Z84N1326Z67N576Z79N1326Z67N576Z79N1326Z67N576Z79N1326Z67N576Z76N1329Z67N576Z76N1329Z64N581Z72N1331Z64N581Z72N1331Z64N581Z72N1331Z64N581Z67N1336Z64N581Z67N1336Z64N584Z61N1339Z64N584Z61N1339Z64N584Z61N1339Z64N584Z56N1344Z64N584Z56N1344Z64N586Z52N1346Z64N586Z52N1346Z64N586Z52N1346Z62N588Z46N1352Z62N588Z46N1352Z62N591Z41N1354Z62N591Z41N1354Z62N591Z41N1354Z62N591Z38N1357Z62N591Z38N1357Z62N591Z38N1360Z56N599Z31N1362Z56N599Z31N1364Z51N605Z23N1369Z51N605Z23N1369Z51N605Z23N1372Z46N2002Z46N2007Z36N2012Z36N2012Z36N2017Z26N2022Z26N2025Z17N2031Z17N2031Z17N2033Z13N2035Z13N2038Z5N2043Z5N2043Z5N519175Z"
    encoding_map = {'Z':0, 'N':1}
    decoded_mask = decode_bitmap_rle(encoded_mask, encoding_map)
    seg_mask_channel = np.array(decoded_mask, dtype=np.uint8).reshape((2048, 2048))
    assert seg_mask_channel.shape == (2048, 2048)
